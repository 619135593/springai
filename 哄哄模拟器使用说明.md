# 💖 哄哄模拟器 - SpringAI 游戏系统

## 🎮 项目概述

为SpringAI项目新增了完整的游戏化聊天系统 - **哄哄模拟器**，这是一个有趣的情感交互游戏，玩家需要通过合适的对话来哄女朋友开心，达到原谅值100分即可通关。

## 📁 项目结构

### 新增文件说明
```
src/main/resources/static/
├── game.html           # 哄哄模拟器游戏界面
├── game-style.css      # 游戏专用样式（粉色恋爱主题）
└── game-script.js      # 游戏逻辑控制（JSDoc注释）

src/main/java/com/example/springaichat/
├── controller/
│   ├── GameController.java      # 游戏后端接口（已存在）
│   └── IndexController.java     # 更新：添加游戏路由
└── constants/
    └── SystemConstants.java     # 游戏系统提示词（已存在）
```

## 🚀 快速启动

### 1. 启动游戏
```bash
# 启动Spring Boot应用
mvn spring-boot:run
```

### 2. 访问游戏界面
- 🎮 游戏页面：`http://localhost:8080/game`
- 🎮 备用路径：`http://localhost:8080/simulator`
- 🎮 直接访问：`http://localhost:8080/game.html`
- 💬 普通聊天：`http://localhost:8080/` 或 `http://localhost:8080/chat`

## ✨ 游戏特性

### 🎯 游戏机制
- **角色扮演**：AI扮演生气的女朋友，玩家需要哄她开心
- **积分系统**：初始原谅值20分，目标达到100分通关，降到0分失败
- **情绪反馈**：根据玩家回复给出不同分数（-10到+10分）
- **实时状态**：动态显示原谅值、心情表情、游戏进度

### 🎨 界面设计
- **游戏化UI**：粉色恋爱主题，渐变背景，卡片设计
- **动态反馈**：
  - 实时原谅值进度条
  - 女朋友心情表情变化（😡😠😐🙂😊😍）
  - 得分显示（正分绿色，负分红色，零分蓝色）
- **响应式布局**：完美适配手机、平板、桌面设备

### 💡 交互功能
- **流式对话**：AI回复实时逐字显示
- **游戏控制**：重新开始、游戏提示、返回主页
- **智能提示**：内置游戏攻略和对话技巧
- **状态管理**：会话ID管理，游戏状态持久化

## 🎲 游戏规则详解

### 📊 评分标准
| 得分 | 情况描述 | 女朋友反应 | 表情 |
|------|----------|------------|------|
| +10分 | 非常开心 | 非常满意的回应 | 😍 |
| +5分  | 开心     | 比较满意的回应 | 😊 |
| 0分   | 正常     | 中性回应       | 😐 |
| -5分  | 生气     | 不满意的回应   | 😠 |
| -10分 | 非常生气 | 非常不满的回应 | 😡 |

### 🎯 胜负条件
- **🎉 胜利条件**：原谅值达到100分
- **💔 失败条件**：原谅值降至0分
- **🎮 初始状态**：原谅值20分

### 💬 对话技巧
#### ✅ 推荐做法
- 💖 **真诚道歉**：承认错误，表达悔意
- 🎁 **主动补偿**：提出浪漫约会或礼物
- 👂 **耐心倾听**：关心她的感受和想法
- 💕 **甜言蜜语**：表达爱意，夸奖她的美丽
- 🤗 **温柔体贴**：展现关怀和理解

#### ❌ 避免行为
- 🚫 **转移话题**：逃避问题或岔开话题
- 🚫 **反驳争辩**：为自己辩护或反击
- 🚫 **态度敷衍**：不诚恳或应付了事
- 🚫 **继续踩雷**：重复引起争吵的行为
- 🚫 **情绪失控**：表现出不耐烦或愤怒

## 🔧 技术实现

### 前端技术
- **游戏框架**：ES6类架构，模块化设计
- **状态管理**：完整的游戏状态机制
- **流式处理**：Stream API实现实时对话
- **动画效果**：CSS3动画，流畅的视觉反馈
- **响应式设计**：移动端优化，触摸友好

### 后端接口
- **游戏接口**：`GET /ai/game?prompt=...&chatId=...`
- **响应格式**：流式文本输出（text/html）
- **AI模型**：使用专门的游戏ChatClient
- **会话管理**：基于chatId的对话历史

### 核心算法
```javascript
// 游戏状态解析
parseGameResponse(response) {
    const scoreMatch = response.match(/得分：([+-]?\d+)/);
    const forgivenessMatch = response.match(/原谅值：(\d+)\/100/);
    return { score, forgiveness };
}

// 心情状态映射
updateMood(score, forgiveness) {
    if (forgiveness >= 80) return '😍';      // 非常开心
    else if (forgiveness >= 60) return '😊'; // 开心
    else if (forgiveness >= 40) return '🙂'; // 微笑
    else if (forgiveness >= 20) return '😐'; // 中性
    else if (forgiveness >= 10) return '😠'; // 生气
    else return '😡';                        // 愤怒
}
```

## 🎪 游戏界面预览

```
┌─────────────────────────────────────────────────────────┐
│ 💖 哄哄模拟器           游戏状态: 进行中  原谅值: 45/100│
├─────────────────────────────────────────────────────────┤
│ 💔 分手 ████████████░░░░░░░░░░░░░░ 💖 原谅            │
├─────────────────────────────────────────────────────────┤
│                    😐                                   │
│                   👩‍🦰                                   │
├─────────────────────────────────────────────────────────┤
│ 🎯 游戏规则                                              │
│ • 你的女朋友生气了，需要你哄她开心                        │
│ • 初始原谅值为20，达到100分通关                           │
│ • 原谅值降到0分则游戏失败                                 │
│                                                         │
│                                  你怎么能这样说！ 👩‍🦰   │
│                         得分：-5  原谅值：15/100        │
│                                                         │
│ 对不起宝贝，我错了 💌                            👤    │
│                                                         │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────┐ ┌─────┐                    │
│ │ 输入你想说的话...        │ │发送💌│                    │
│ └─────────────────────────┘ └─────┘                    │
│ 🔄 重新开始  💡 游戏提示                     125/500   │
└─────────────────────────────────────────────────────────┘
```

## 🎯 游戏示例

### 📝 典型游戏流程

#### 游戏开始
```
玩家：女朋友问她的闺蜜谁好看我说都好看，她生气了

AI：游戏开始，请现在开始哄你的女朋友开心吧，回复让她开心的话！
得分：0
原谅值：20/100
```

#### 错误示例（失败路径）
```
玩家：你闺蜜真的蛮好看的

AI：(生气)你怎么这么说，你是不是喜欢她？
得分：-10
原谅值：10/100

玩家：有一点点心动

AI：(愤怒)那你找她去吧！
得分：-10
原谅值：0/100
游戏结束，你的女朋友已经甩了你！
```

#### 正确示例（成功路径）
```
玩家：在我心里你永远是最美的！

AI：(微笑)哼，我怎么知道你说的是不是真的？
得分：+10
原谅值：30/100

玩家：我发誓，你是我见过最漂亮的女孩

AI：(害羞)真的吗？那你以后不许再夸别的女生了
得分：+10
原谅值：40/100

玩家：我保证，只有你一个人在我心里

AI：(开心)好吧，我勉强相信你这次...
得分：+15
原谅值：55/100
```

## 🎨 界面功能详解

### 🎮 游戏头部
- **游戏标题**：💖 哄哄模拟器
- **副标题**：用你的情商拯救你的恋爱关系！
- **状态显示**：实时游戏状态和原谅值

### 📊 进度条区域
- **可视化进度**：原谅值的直观显示
- **渐变效果**：从红色（分手）到绿色（原谅）
- **动画过渡**：平滑的数值变化动画

### 👩‍🦰 角色场景
- **女朋友形象**：可爱的emoji角色
- **心情指示器**：实时情绪表情变化
- **视觉反馈**：根据得分动态更新

### 💬 聊天区域
- **消息气泡**：用户和AI的差异化设计
- **得分显示**：彩色得分卡片
- **流式显示**：AI回复逐字出现
- **自动滚动**：始终显示最新消息

### 🎯 控制面板
- **重新开始**：快速重置游戏状态
- **游戏提示**：详细攻略和技巧
- **字符计数**：输入限制提示
- **发送按钮**：美观的消息发送

### 🏆 结果弹窗
- **胜利界面**：🎉 庆祝成功哄好女朋友
- **失败界面**：💔 分手结果和重新开始
- **操作选项**：再玩一次或返回主页

## 📱 移动端优化

### 响应式特性
- **自适应布局**：完美适配各种屏幕尺寸
- **触摸友好**：适合手指操作的按钮尺寸
- **性能优化**：流畅的动画和交互
- **视觉适配**：移动端的字体和间距优化

### 操作便利
- **虚拟键盘支持**：输入框自动适配
- **手势操作**：支持滑动滚动
- **快捷操作**：长按、双击等交互
- **状态保持**：旋转屏幕状态不丢失

## 🛠️ 开发者指南

### 自定义游戏规则
修改 `SystemConstants.java` 中的 `GAME_SYSTEM_PROMPT`：
```java
public static final String GAME_SYSTEM_PROMPT = """
    // 在这里自定义游戏规则
    - 修改初始原谅值
    - 调整得分范围
    - 自定义角色设定
    - 增加新的游戏机制
""";
```

### 扩展游戏功能
1. **多角色支持**：添加不同性格的女朋友
2. **难度等级**：简单、普通、困难模式
3. **成就系统**：解锁特殊称号和奖励
4. **排行榜**：最高分数和通关时间
5. **剧情模式**：预设的特定场景

### 样式自定义
修改 `game-style.css` 中的主题色彩：
```css
:root {
    --primary-color: #ff6b9d;      /* 主色调 */
    --secondary-color: #c44569;    /* 辅助色 */
    --success-color: #00b894;      /* 成功色 */
    --danger-color: #e17055;       /* 危险色 */
    --background: #ff9a9e;         /* 背景色 */
}
```

## 🎪 高级功能

### 🎭 多角色系统（规划中）
- **性格设定**：温柔型、傲娇型、女王型
- **难度差异**：不同性格的女朋友有不同的容忍度
- **对话风格**：每种性格都有独特的回复方式

### 🏆 成就系统（规划中）
- **首次通关**：恋爱新手
- **连续胜利**：情商高手
- **完美得分**：甜言蜜语大师
- **速通记录**：哄哄闪电侠

### 📊 数据统计（规划中）
- **游戏次数**：总游戏场次
- **胜率统计**：成功哄好的概率
- **平均得分**：每局平均表现
- **最佳记录**：最高分和最快通关

## 🎯 总结

哄哄模拟器为SpringAI项目带来了：

### ✅ 技术价值
- **游戏化应用**：展示AI在娱乐领域的应用
- **交互设计**：完整的用户体验设计
- **状态管理**：复杂的前端状态控制
- **流式处理**：实时数据流处理技术

### 🎮 用户体验
- **娱乐性强**：有趣的游戏化聊天体验
- **教育意义**：学习情感交流技巧
- **社交价值**：可以和朋友一起体验
- **重玩性高**：每次游戏都有不同的体验

### 🚀 扩展潜力
- **教育应用**：情商训练、沟通技巧
- **商业价值**：可以扩展为完整的游戏产品
- **技术展示**：SpringAI能力的完美展示
- **社区互动**：可以添加社交分享功能

**🎉 现在就开始你的哄哄模拟器之旅吧！测试你的情商，拯救你的恋爱关系！**

---

**访问地址**：
- 🎮 游戏入口：`http://localhost:8080/game`
- 💻 开发文档：[SpringAI GitHub](https://github.com/spring-projects/spring-ai)
- 🤝 技术支持：查看控制台日志或浏览器开发者工具 