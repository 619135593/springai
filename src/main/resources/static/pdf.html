<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“„ ChatPDF - æ™ºèƒ½PDFé—®ç­”åŠ©æ‰‹</title>
    <link rel="stylesheet" href="pdf-style.css">
    <link rel="shortcut icon" href="data:text/plain;," type="image/x-icon">
</head>
<body>
    <div class="pdf-container">
        <!-- å¤´éƒ¨åŒºåŸŸ -->
        <div class="pdf-header">
            <button class="back-button" onclick="backToHomePage()">
                â† è¿”å›é¦–é¡µ
            </button>
            <div class="pdf-title">
                <h1>ğŸ“„ ChatPDF</h1>
                <p class="pdf-subtitle">æ™ºèƒ½PDFæ–‡æ¡£é—®ç­”åŠ©æ‰‹</p>
            </div>
            <div class="status-indicator">
                <div class="status-item">
                    <span class="status-label">è¿æ¥:</span>
                    <span class="status-value" id="chatStatus">æœªå¼€å§‹</span>
                </div>
                <div class="status-item">
                    <span class="status-label">æ–‡æ¡£:</span>
                    <span class="status-value" id="fileStatus">æœªä¸Šä¼ </span>
                </div>
            </div>
        </div>

        <!-- ä¸»å†…å®¹åŒºåŸŸ - åˆå¹¶ä¸Šä¼ å’ŒèŠå¤© -->
        <div class="main-content">
            
            <!-- æ–‡æ¡£ä¸Šä¼ /ä¿¡æ¯åŒºåŸŸ -->
            <div class="document-section" id="documentSection">
                
                <!-- æœªä¸Šä¼ çŠ¶æ€ - ä¸Šä¼ åŒºåŸŸ -->
                <div class="upload-area" id="uploadArea">
                    <div class="upload-icon">ğŸ“„</div>
                    <div class="upload-text">
                        <h3>æ‹–æ‹½PDFæ–‡ä»¶åˆ°æ­¤å¤„æˆ–ç‚¹å‡»é€‰æ‹©</h3>
                        <p>æ”¯æŒPDFæ ¼å¼ï¼Œæ–‡ä»¶å¤§å°ä¸è¶…è¿‡50MB</p>
                    </div>
                    <input type="file" id="fileInput" class="file-input" accept=".pdf,application/pdf">
                    <button class="upload-button" id="uploadButton">
                        é€‰æ‹©PDFæ–‡ä»¶
                    </button>
                </div>

                <!-- ä¸Šä¼ è¿›åº¦çŠ¶æ€ -->
                <div class="upload-progress" id="uploadProgress" style="display: none;">
                    <div class="progress-info">
                        <div class="progress-icon">â³</div>
                        <h4>æ­£åœ¨å¤„ç†æ‚¨çš„PDFæ–‡æ¡£...</h4>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <p id="progressText">è§£ææ–‡æ¡£å†…å®¹ä¸­...</p>
                </div>

                <!-- å·²ä¸Šä¼ çŠ¶æ€ - æ–‡æ¡£ä¿¡æ¯ -->
                <div class="document-info" id="documentInfo" style="display: none;">
                    <div class="doc-icon">ğŸ“„</div>
                    <div class="doc-details">
                        <h4 id="docName">æ–‡æ¡£åç§°</h4>
                        <p id="docSize">æ–‡ä»¶å¤§å°</p>
                        <span class="doc-status">âœ… å·²è§£æå®Œæˆï¼Œå¯ä»¥å¼€å§‹å¯¹è¯</span>
                    </div>
                    <button class="change-doc-button" onclick="changeDocument()">æ›´æ¢æ–‡æ¡£</button>
                </div>

                <!-- å…¨å±€çŸ¥è¯†åº“çŠ¶æ€ -->
                <div class="global-knowledge-base" id="globalKnowledgeBase" style="display: none;">
                    <div class="kb-header">
                        <div class="kb-icon">ğŸŒ</div>
                        <div class="kb-details">
                            <h4>å…¨å±€çŸ¥è¯†åº“</h4>
                            <p id="kbStats">æ­£åœ¨åŠ è½½...</p>
                        </div>
                        <button class="refresh-kb-button" onclick="refreshKnowledgeBase()" title="åˆ·æ–°çŸ¥è¯†åº“">
                            ğŸ”„
                        </button>
                    </div>
                    
                    <div class="kb-documents" id="kbDocuments">
                        <div class="documents-header">
                            <h5>ğŸ“š å·²ä¸Šä¼ æ–‡æ¡£</h5>
                            <button class="toggle-docs-button" id="toggleDocsButton" onclick="toggleDocumentsList()">
                                æ˜¾ç¤ºåˆ—è¡¨ â–¼
                            </button>
                        </div>
                        <div class="documents-list" id="documentsList" style="display: none;">
                            <div class="loading-docs">æ­£åœ¨åŠ è½½æ–‡æ¡£åˆ—è¡¨...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- èŠå¤©åŒºåŸŸ -->
            <div class="chat-section" id="chatSection">
                
                <!-- æ¬¢è¿æ¶ˆæ¯/èŠå¤©æ¶ˆæ¯åŒºåŸŸ -->
                <div class="chat-messages" id="chatMessages">
                    <div class="welcome-message" id="welcomeMessage">
                        <div class="welcome-content">
                            <div class="welcome-icon">ğŸ¤–</div>
                            <h3>ğŸ¯ æ¬¢è¿ä½¿ç”¨ChatPDFå…¨å±€æ™ºèƒ½é—®ç­”</h3>
                            <div class="feature-list">
                                <div class="feature-item">
                                    <span class="feature-icon">ğŸ“„</span>
                                    <span>è¯·ä¸Šä¼ PDFæ–‡æ¡£ï¼Œæ‰€æœ‰æ–‡æ¡£ä¼šè‡ªåŠ¨åŠ å…¥å…¨å±€çŸ¥è¯†åº“</span>
                                </div>
                                <div class="feature-item">
                                    <span class="feature-icon">ğŸŒ</span>
                                    <span>AIå¯ä»¥åŸºäºæ‰€æœ‰å·²ä¸Šä¼ çš„PDFæ–‡æ¡£è¿›è¡Œæ™ºèƒ½é—®ç­”</span>
                                </div>
                                <div class="feature-item">
                                    <span class="feature-icon">ğŸ”</span>
                                    <span>æ”¯æŒè·¨æ–‡æ¡£æ£€ç´¢ï¼Œæ‰¾åˆ°æœ€ç›¸å…³çš„ä¿¡æ¯å›ç­”æ‚¨çš„é—®é¢˜</span>
                                </div>
                                <div class="feature-item">
                                    <span class="feature-icon">ğŸ’¡</span>
                                    <span>æ”¯æŒæ–‡æ¡£å¯¹æ¯”ã€æ€»ç»“ã€å…³è”åˆ†æç­‰é«˜çº§åŠŸèƒ½</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- è¾“å…¥åŒºåŸŸ -->
                <div class="input-area" id="inputArea">
                    <div class="input-container">
                        <textarea 
                            id="messageInput" 
                            placeholder="è¯·å…ˆä¸Šä¼ PDFæ–‡æ¡£åå†è¿›è¡Œæé—®..." 
                            maxlength="1000"
                            rows="1"
                            disabled></textarea>
                        <div class="input-actions">
                            <div class="char-count" id="charCount">0/1000</div>
                            <button class="clear-button" onclick="clearChat()" title="æ¸…ç©ºå¯¹è¯" disabled>
                                ğŸ—‘ï¸
                            </button>
                            <button class="send-button" id="sendButton" onclick="sendMessage()" disabled>
                                <span class="send-text">å‘é€</span>
                                <span class="send-icon">ğŸ“¤</span>
                            </button>
                        </div>
                    </div>
                    <div class="loading-indicator" id="loadingIndicator" style="display: none;">
                        <div class="loading-dots">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                        <span class="loading-text">AIæ­£åœ¨æ€è€ƒä¸­...</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- é€šçŸ¥å®¹å™¨ -->
    <div class="notification-container" id="notificationContainer"></div>

    <script src="pdf-script.js"></script>
    <script>
        /**
         * è¿”å›é¦–é¡µ
         */
        function backToHomePage() {
            if (confirm('ç¡®å®šè¦è¿”å›é¦–é¡µå—ï¼Ÿå½“å‰å¯¹è¯è®°å½•å°†ä¼šä¿ç•™ã€‚')) {
                window.location.href = '/';
            }
        }

        /**
         * æ›´æ¢æ–‡æ¡£
         */
        function changeDocument() {
            if (window.pdfChatManager) {
                window.pdfChatManager.changeDocument();
            }
        }

        /**
         * æ¸…ç©ºå¯¹è¯
         */
        function clearChat() {
            if (window.pdfChatManager) {
                window.pdfChatManager.clearChat();
            }
        }

        /**
         * å‘é€æ¶ˆæ¯
         */
        function sendMessage() {
            if (window.pdfChatManager) {
                window.pdfChatManager.sendMessage();
            }
        }

        /**
         * å¡«å……ç¤ºä¾‹é—®é¢˜
         * @param {HTMLElement} element ç‚¹å‡»çš„é—®é¢˜æ ‡ç­¾å…ƒç´ 
         */
        function fillQuestion(element) {
            const question = element.textContent;
            const messageInput = document.getElementById('messageInput');
            if (messageInput && window.pdfChatManager) {
                messageInput.value = question;
                window.pdfChatManager.updateCharCount();
                messageInput.focus();
            }
        }
    </script>
</body>
</html> 